<h1 align="center">üì¶ StockFlow Nexus</h1>
<h4 align="center">Sistema integrado para gest√£o de estoque, vendas e processos fiscais</h4>

<div align="center">

![GitHub](https://img.shields.io/badge/Python-3.8+-blue?logo=python)
![GitHub](https://img.shields.io/badge/Flask-2.0+-green?logo=flask)
![GitHub](https://img.shields.io/badge/SQL_Server-2019+-red?logo=microsoft-sql-server)

  <br>
  <img src="https://i.imgur.com/yqc3ONP.png" width="875px" alt="Imagem Principal">
</div>

---

## üéØ Funcionalidades

### üîê Autentica√ß√£o & Controle de Acesso
- Login com diferencia√ß√£o de cargos
- Acesso restrito por setor (estoque, vendas, fiscal)

### üìä M√≥dulos Principais

| Recurso                     | Descri√ß√£o                                                                                    |
|-----------------------------|----------------------------------------------------------------------------------------------|
| **Consulta de Estoque**     | Filtros avan√ßados + informa√ß√µes detalhadas de produtos e entregas                            |
| **Status de Pedido**        | Visualiza√ß√£o colorida com alertas de urg√™ncia                                                |
| **Regras Fiscais**          | Automa√ß√£o de cadastro por NCM com m√∫ltiplas combina√ß√µes                                      |
| **Ranking de Vendas**       | Gr√°ficos de desempenho + relat√≥rios autom√°ticos                                              |
| **Consulta CNPJ**           | Integra√ß√£o com API + cadastro autom√°tico                                                     |
| **Dashboard de Vendas**     | 3 vers√µes personalizadas (admin/gerente/vendedor) com m√©tricas chave                         |
| **Automa√ß√£o de Relat√≥rio**  | Gera√ß√£o autom√°tica de PDF com informa√ß√µes da loja e envio di√°rio para contabilidade          |
| **Gerenciador de Entregas** | Pesquisa de pedidos, coleta assinatura digital e gera PDF de confirma√ß√£o de entrega.         |
| **Vendas por Pix**          | Emiss√£o de QR Code Pix com timer, monitoramento de status e libera√ß√£o autom√°tica de pedidos. |

---

## üì∏ Visualiza√ß√µes do Sistema

> ### Dashboard de Vendas

**Resumo:**  

O Dashboard de Vendas centraliza as principais m√©tricas comerciais em uma interface interativa. Destaca-se pelos filtros personalizados (empresa, vendedor, m√™s e ano), indicadores de performance (or√ßamentos, venda total, lucro e comiss√£o), gr√°ficos interativos, o de rosca para acompanhar a meta de forma visual e o de barras para acompanhar as vendas em cada dia do m√™s, al√©m de uma ferramenta de busca detalhada de pedidos. 

Para o c√≥digo, eu fiz querys otimizadas para exibir as informa√ß√µes que eu queria e utilizei o m√©todo GET com os filtros que o Front End tem para funcionar dentro do esperado. O sistema conta com blueprints do flask para organizar as def's e pyodbc para conex√£o com o banco de dados.

<div align="center">
  <img src="https://i.imgur.com/LPKhjHz.png" width="670px" alt="Dashboard de Vendas">
</div>

> ### Gerenciador de Entregas

**Resumo:**  

O Gerenciador de Entregas centraliza todo o fluxo de confer√™ncia e confirma√ß√£o de entregas em uma interface simples. O usu√°rio do setor de estoque pesquisa pedidos liberados ou ‚ÄúEntregue Part.‚Äù, escolhe entre entrega ‚Äútudo‚Äù (quantidade m√°xima) ou ‚Äúparte‚Äù (quantidade customizada), preenche nome, telefone e CPF (com valida√ß√£o) do respons√°vel e captura a assinatura digital via tablet antes de confirmar a opera√ß√£o.

Para o c√≥digo, utilizei rotas GET para /pesquisar e /modal_detalhes e POST para /gerar_pdf. As consultas SQL otimizadas via PyODBC retornam os produtos e quantidades j√° entregues; no frontend, JavaScript aplica m√°scaras e valida√ß√µes de CPF/telefone, monta o modal e captura a assinatura em Base64. No backend, a assinatura √© decodificada com PIL, o template √© renderizado via Jinja2 e o PDF √© gerado com pdfkit, tudo em uma transa√ß√£o que atualiza o status da venda e insere os registros de entrega no banco.

<table>
  <tr>
    <td align="center">
      <img src="https://i.imgur.com/Uq5Ud5F.jpeg" width="650px" alt="Consulta Pedido">
    </td>
    <td align="center">
      <img src="https://i.imgur.com/4Gk3AgG.jpeg" width="650px" alt="Relat√≥rio de Entrega">
    </td>
  </tr>
</table>

> ### Pagamento via Pix

**Resumo:**  

A P√°gina Pix centraliza a emiss√£o e o acompanhamento de cobran√ßas em QR Code em uma interface pr√°tica. O usu√°rio informa o n√∫mero do pedido, visualiza o QR Code e o ‚ÄúPix copia e cola‚Äù com um contador regressivo de 3‚ÄØh, e pode cancelar cobran√ßas ativas. Quando o pagamento √© confirmado via API, o sistema libera automaticamente o pedido para entrega.

A integra√ß√£o come√ßou no Postman, obtendo o certificado SSL (mTLS) e tokens OAuth2; em produ√ß√£o, as credenciais s√£o descriptografadas em tempo real. As chamadas HTTP usam requests com certificados cliente, e uma thread monitora o status do QR via API do banco. No backend, PyODBC atualiza as tabelas Pix_QR, Venda e FluxoCaixa; no frontend, JavaScript e QRCodeStyling.js geram o c√≥digo, exibem o timer e controlam a√ß√µes de c√≥pia e cancelamento.

<table>
  <tr>
    <td align="center">
      <img src="https://i.imgur.com/Ew6ibLy.jpeg" width="650px" alt="Pagamento Pendente">
    </td>
    <td align="center">
      <img src="https://i.imgur.com/3BSSsel.jpeg" width="650px" alt="Pagamento Confirmado">
    </td>
  </tr>
</table>

> ### Regras Fiscais

**Resumo:**<br>

O M√≥dulo Fiscal centraliza a automa√ß√£o do cadastro e a gest√£o de perfis fiscais, permitindo a gera√ß√£o din√¢mica de registros com base em par√¢metros essenciais como NCM, CFOP e origens. Com fun√ß√µes otimizadas, o sistema mapeia diversas combina√ß√µes de tributa√ß√£o ‚Äì incluindo as variantes de regime normal e simples, finalidades e caracter√≠sticas espec√≠ficas ‚Äì para criar perfis detalhados que atendem aos diferentes cen√°rios fiscais.

Para o c√≥digo, foram implementadas fun√ß√µes que realizam a consulta do √∫ltimo ID, a cria√ß√£o de registros por meio de mapeamentos precisos e a inser√ß√£o automatizada dos dados no banco utilizando pyodbc. A integra√ß√£o com o frontend se d√° por meio de rotas REST em Flask, permitindo a pr√©-visualiza√ß√£o em tempo real dos dados gerados em formato de tabela, garantindo que os usu√°rios possam revisar e confirmar as informa√ß√µes antes da inser√ß√£o definitiva. Este m√≥dulo robusto assegura consist√™ncia, agilidade e confiabilidade nos processos fiscais do sistema.

<div align="center">
  <img src="https://i.imgur.com/3HJDiM3.png" width="670px" alt="Regras Fiscais">
</div>

Por exemplo:
- **73181900 - A R S 2 5405**
  - **73181900**: C√≥digo NCM
  - **A**: Tipo do Cliente
  - **R**: Tipo de Mercadoria
  - **S**: Indicador de Simples Nacional
  - **2**: Origem
  - **5405**: CFOP

### Como funciona:

1. **NCM**: C√≥digo que identifica a classifica√ß√£o fiscal da mercadoria.
2. **Tipo do Cliente**: Define o perfil do cliente que ser√° atendido.
3. **Tipo de Mercadoria**: Especifica se a mercadoria √© para revenda, insumo ou uso/consumo imobilizado.
4. **Simples Nacional**: Indicador que define se a opera√ß√£o se enquadra no regime do Simples Nacional.
5. **Origem**: Representa a origem da mercadoria.
6. **CFOP**: C√≥digo Fiscal de Opera√ß√µes e Presta√ß√µes.

<table style="border-collapse: collapse; border: none;">
  <tr>
    <td style="vertical-align: top; border: none;">
      <h3>Tabela de Tipos de Cliente</h3>
      <table>
        <tr>
          <th>C√≥digo</th>
          <th>Descri√ß√£o</th>
        </tr>
        <tr>
          <td>A</td>
          <td>Atacadista</td>
        </tr>
        <tr>
          <td>D</td>
          <td>Distribuidor</td>
        </tr>
        <tr>
          <td>PF</td>
          <td>Pessoa F√≠sica</td>
        </tr>
        <tr>
          <td>PJ</td>
          <td>Pessoa Jur√≠dica n√£o contribuinte do ICMS</td>
        </tr>
        <tr>
          <td>V</td>
          <td>Varejista</td>
        </tr>
      </table>
    </td>
    <td style="vertical-align: top; border-left: 1px solid #000; padding-left: 10px; border: none;">
      <h3>Tabela de Tipos de Mercadoria</h3>
      <table>
        <tr>
          <th>C√≥digo</th>
          <th>Descri√ß√£o</th>
        </tr>
        <tr>
          <td>R</td>
          <td>Revenda</td>
        </tr>
        <tr>
          <td>I</td>
          <td>Insumo</td>
        </tr>
        <tr>
          <td>U</td>
          <td>Uso e Consumo Imobilizado</td>
        </tr>
      </table>
    </td>
  </tr>
</table>


> **Nota:** A utiliza√ß√£o do **pandas** permite a manipula√ß√£o eficiente dos dados fiscais, possibilitando a gera√ß√£o din√¢mica e a pr√©-visualiza√ß√£o dos perfis fiscais antes da inser√ß√£o no banco de dados. <br>

>### Relat√≥rios Gerados

A funcionalidade de relat√≥rios do sistema √© respons√°vel por extrair, compilar e apresentar os dados de vendas de forma clara e objetiva. A seguir, um resumo superficial de como o processo funciona:

- **Consulta e Agrega√ß√£o de Dados:**  
  Utiliza-se **PyODBC** para conectar ao **SQL Server 2019+** e executar consultas SQL otimizadas com **CTEs** (Common Table Expressions) para o sistema funcionar da melhor maneira. 

- **Renderiza√ß√£o e Gera√ß√£o de PDF:**  
  Ap√≥s coletar os dados, o sistema utiliza o **Jinja2** para renderizar um template HTML (com suporte de **HTML5/CSS3**), que √© posteriormente convertido em um arquivo PDF por meio do **PDFKit**. Esse PDF serve como um relat√≥rio completo e visualmente estruturado.

- **Automa√ß√£o e Envio de E-mail:**  
  A automa√ß√£o √© implementada usando as bibliotecas **Schedule** e **Threading**, que agendam e executam a gera√ß√£o dos relat√≥rios em hor√°rios predefinidos. Uma vez gerado, o relat√≥rio √© enviado automaticamente via e-mail utilizando o **SMTPLib**, permitindo o envio de anexos (os relat√≥rios em PDF) para os destinat√°rios cadastrados.

<table>
  <tr>
    <td align="center">
      <img src="https://i.imgur.com/rCnyWof.png" width="650px" alt="Relat√≥rio Di√°rio">
    </td>
    <td align="center">
      <img src="https://i.imgur.com/m0PxsSV.png" width="650px" alt="Relat√≥rio Mensal">
    </td>
  </tr>
</table>

> **Nota:** Todos os dados exibidos nas imagens s√£o **Fict√≠cios**, gerados por mim apenas para visualiza√ß√£o para demonstrar a funcionalidade do sistema
---

### Tecnologias Utilizadas

| Categoria            | Tecnologias                                                   |
|----------------------|---------------------------------------------------------------|
| **Renderiza√ß√£o**     | PDFKit, Jinja2, HTML5/CSS3                                    |
| **Dados**            | SQL Server¬†2019+, PyODBC, CTEs                                |
| **Automa√ß√£o**        | Schedule, Threading, SMTPLib                                  |
| **API & Ferramentas**| Postman, REST API, Requests, mTLS (SSL cliente)               |
| **Backend**          | Python¬†3.8+, Flask¬†2.x                                        |
| **Frontend**         | JavaScript, Canvas API, QRCodeStyling.js                      |
| **Seguran√ßa**        | AES‚Äë256 (dupla chave), SSL/TLS mTLS, descriptografia din√¢mica |

---

## üìà Impacto Operacional

- **Automa√ß√£o de Regras Fiscais:**  
  Cadastrar regra fiscal manualmente leva cerca de 2 minutos por registro. Com o nosso sistema, √© poss√≠vel cadastrar 30+ regras em minutos, otimizando o tempo e reduzindo erros.

- **Produtividade de Vendas:**  
  Os vendedores podem acompanhar seu desempenho em tempo real, o que resultou em um aumento de aproximadamente 26% na produtividade da equipe.

- **Gest√£o de Estoque:**  
  A facilidade de confer√™ncia do estoque eliminou problemas recorrentes, garantindo maior efici√™ncia e precis√£o no controle.

- **Entrega de Produtos:**  
  A gera√ß√£o de entregas com assinatura digital automatizou o processo e eliminou a necessidade de impress√£o de formul√°rios, economizando tempo e recursos.

- **Pagamentos via PIX:**  
  O processo de emiss√£o, monitoramento e confirma√ß√£o autom√°tica de QR Codes reduziu fraudes e liberou os pedidos de forma mais r√°pida e segura.

| Funcionalidade            | Benef√≠cio Direto                             | Impacto Mensur√°vel                     |
|---------------------------|----------------------------------------------|----------------------------------------|
| Consulta CNPJ             | Redu√ß√£o de 70% no tempo de cadastro          | +150 clientes cadastrados/dia          |
| Ranking de Vendas         | Aumento de 25% na produtividade da equipe    | 100% de precis√£o em comiss√µes          |
| Relat√≥rio Autom√°tico      | Entregas 100% dentro do prazo legal          | Redu√ß√£o em inconsist√™ncias             |
| Gera√ß√£o de regra fiscal   | Erros minimizados no registro                | 15h/m√™s economizadas em an√°lises       |
| Entrega de Produtos       | Processo 100% digital e rastre√°vel           | ‚âà250 folhas/dia economizadas           |
| Pagamentos via PIX        | Libera√ß√£o autom√°tica e segura de pedidos     | Redu√ß√£o de fraudes e valida√ß√µes manuais|

---

## üóÇ Estrutura do Projeto

```plaintext
StockFlowNexus/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ credenciais.enc.json   # Credenciais criptografadas
‚îÇ   ‚îú‚îÄ‚îÄ chave1                 # Chave prim√°ria AES-256
‚îÇ   ‚îî‚îÄ‚îÄ chave2                 # Chave secund√°ria AES-256
‚îÇ
‚îú‚îÄ‚îÄ blueprints/                # M√≥dulos funcionais
‚îÇ   ‚îú‚îÄ‚îÄ auth.py               üîê Autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ estoque.py            üì¶ Gest√£o de estoque
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.py          üìä M√≥dulo de analytics
‚îÇ   ... 
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ database.py           üóÉ Conex√£o SQL Server
‚îÇ   ‚îî‚îÄ‚îÄ encryption.py         üîë Sistema de criptografia
‚îÇ
‚îî‚îÄ‚îÄ static/                   üé® Assets frontend
    ‚îú‚îÄ‚îÄ css/                  üé® Estilos globais
    ‚îî‚îÄ‚îÄ js/                   üõ† Scripts principais
```
